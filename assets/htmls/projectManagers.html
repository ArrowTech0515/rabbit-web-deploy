<div class="py-24px min-h-500">
    <div class="text-end mb-3">
        <div class="dropdown">
            <a href="javascript:;" class="btn btn-primary pageBtn addnewkeyBtn" id="landingDropdown" data-bs-toggle="dropdown" aria-expanded="false"><i class="fas fa-plus"></i> Add New Manager</a>
            <div class="dropdown-menu dropdown-menu-end account_dropdown mt-2 mb-2 shadow border-0" aria-labelledby="landingDropdown">
                <form>
                    <div class="text-right">
                        <a href="javascript:;" class="close" title="Close" data-bs-dismiss="modal" aria-label="Close">
                            <img src="/assets/images/icon/remove.png" alt="Close">
                        </a>
                    </div>
                    <div class="mb-3">
                        <label class="dropTitle">Add New Manager</label>
                    </div>
                    <div class="mb-3">
                        <div class="d-md-flex justify-content-between align-items-center">
                            <label class="dropdownLable">Name</label>
                            <input type="text" class="form-control" placeholder="Name"/>
                        </div>
                    </div>
                    <div class="mb-3">
                        <div class="d-md-flex justify-content-between align-items-center">
                            <label class="dropdownLable">Email</label>
                            <input type="text" class="form-control" placeholder="Email"/>
                        </div>
                    </div>
                    <div class="mb-3">
                        <div class="d-md-flex justify-content-between align-items-center">
                            <label class="dropdownLable">Password</label>
                            <input type="password" class="form-control" placeholder="Password"/>
                        </div>
                    </div>
                    <div class="mb-3">
                        <div class="d-md-flex justify-content-between align-items-center">
                            <label class="dropdownLable">Websites</label>
                            <div class="selecttagDiv select2Custom">
                                <select class="form-control select-tag" multiple="multiple">
                                    <option selected="selected">xplace.co.il</option>
                                    <option>zoominfo.com</option>
                                    <option>purple.com</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="" id="emailCheckbox" checked>
                            <label class="form-check-label mb-0" for="emailCheckbox">
                                Email now
                            </label>
                        </div>
                    </div>
                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="" id="projects">
                            <label class="form-check-label mb-0" for="projects">
                                Has access to all projects
                            </label>
                        </div>
                    </div>

                    <div class="text-end mt-4">
                        <button type="button" class="btn btn-primary mw-75px" data-bs-toggle="modal" data-bs-target="#savemanagerModal">Save</button>
                    </div>
                </form>
            </div>

        </div>
    </div>

    <div class="rabbitTable table-responsive">
        <table class="table table-borderless align-middle hover">
            <tbody>
            <tr>
                <td><a style="cursor: pointer" class="btn btn-primary arrowBtn"><i class="fas fa-chevron-right"></i></a></td>
                <td>Jone</td>
                <td>rabbit.com</td>
                <td>Lorem ipsum</td>
                <td>0.08</td>
                <td><input type="text" class="form-control w-110px" value="561,000" /></td>
                <td>6</td>
                <td><a href="javascript:;" data-bs-toggle="modal" class="editManger" data-bs-target="#editmanagerModal">Edit</a></td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

<!--Edit Manager-->
<div class="modal rabitseoModal fade" id="editmanagerModal" tabindex="-1" role="dialog" aria-labelledby="editmanagerModalLabel"
     aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header border-bottom-0">
                <h5 class="modal-title" id="editmanagerModalLabel">Edit Manager</h5>
                <a href="javascript:;" class="close" title="Close" data-bs-dismiss="modal" aria-label="Close">
                    <img src="/assets/images/icon/remove.png" alt="Close">
                </a>
            </div>
            <form>
                <div class="modal-body account_dropdown text-left pt-0">
                    <div class="mb-3">
                        <div class="d-md-flex justify-content-between align-items-center">
                            <label class="dropdownLable">Name</label>
                            <input type="text" class="form-control" placeholder="Name"/>
                        </div>
                    </div>
                    <div class="mb-3">
                        <div class="d-md-flex justify-content-between align-items-center">
                            <label class="dropdownLable">Email</label>
                            <input type="text" class="form-control" placeholder="Email"/>
                        </div>
                    </div>
                    <div class="mb-3">
                        <div class="d-md-flex justify-content-between align-items-center">
                            <label class="dropdownLable">Password</label>
                            <input type="password" class="form-control" placeholder="Password"/>
                        </div>
                    </div>
                    <div class="mb-3">
                        <div class="d-md-flex justify-content-between align-items-center">
                            <label class="dropdownLable">Websites</label>
                            <div class="selecttagDiv select2Custom">
                                <select class="form-control select-tag" multiple="multiple">
                                    <option selected="selected">xplace.co.il</option>
                                    <option>zoominfo.com</option>
                                    <option>purple.com</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="" id="emailCheckbox" checked>
                            <label class="form-check-label mb-0" for="emailCheckbox">
                                Email now
                            </label>
                        </div>
                    </div>
                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="" id="projects">
                            <label class="form-check-label mb-0" for="projects">
                                Has access to all projects
                            </label>
                        </div>
                    </div>

                    <div class="text-end mt-4">
                        <button type="button" class="btn btn-primary mw-75px">Save</button>
                    </div>

                </div>

            </form>
        </div>
    </div>
</div>

<!--Success Error Modal-->
<div class="modal rabitseoModal successErrorModal fade" id="savemanagerModal" tabindex="-1" role="dialog" aria-labelledby="editmanagerModalLabel"
     aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header border-bottom-0">
                <h5 class="modal-title" id="editmanagerModalLabel">Add New Manager</h5>
                <a href="javascript:;" class="close" title="Close" data-bs-dismiss="modal" aria-label="Close">
                    <img src="/assets/images/icon/remove.png" alt="Close">
                </a>
            </div>
            <div class="modal-body">
                <div class="success-error-msg">
                    <div class="messageEmoji">
                        <img src="/assets/images/icon/sad.png" alt="Emoji"/>
                        <p class="text-danger">Ups! <br>
                            Project Manager already exist</p>
                    </div>
                </div>
                <div class="success-error-msg">
                    <div class="messageEmoji">
                        <img src="/assets/images/icon/sad.png" alt="Emoji"/>
                        <p class="text-success">Project Manager <br>
                            successfully added!</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!----------------->
<div class="modal fade" id="projectManager" tabindex="-1" role="dialog" aria-labelledby="plansLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="plansLabel">Project Manager</h5>
                <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close">
                </button>
            </div>
            <div class="modal-body">
                <div>
                    <form id="managerForm">
                        <input type="text" name="name" id="managerName" placeholder="Manager Name">
                        <input type="email" name="email" id="managerEmail" placeholder="Manager Email">
                        <!-- <input type="hidden" name="id" id="managerId">                        -->
                        <a id="createManager" onclick="saveManager()">Create</a>
                        <a id="updateManager" onclick="updateManager(this)" style="display: none">Update</a>
                    </form>

                    <table width="100%" id="managerTable" class="table table-striped display" cellspacing="0">
                        <thead>
                        <tr>
                            <th></th>
                            <th>Name</th>
                            <th>Eamil</th>
                            <th>Date Created</th>
                            <th>Last Login</th>
                            <th></th>
                            <th></th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td colspan=5 class="text-center">No data found</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    var language = 'en', rtl = false;
    $(document).ready(function() {
        loadProjectManagers();
    });
    function loadProjectManagers(){
        $.getJSON(apiUrl + 'jsonProjectManager', function(json) {
            json = json.list
            var html = '';
            if (json.length) {
                for (let i = 0; i < json.length; i++) {
                    html +=
                        '<tr id="'+json[i]['id']+'">'+
                        '<td>'+(i+1)+'</td>'+
                        '<td>'+json[i]['name']+'</td>'+
                        '<td>'+json[i]['email']+'</td>'+
                        '<td>'+json[i]['dateCreated']+'</td>'+
                        '<td>'+json[i]['lastLogin']+'</td>'+
                        '<td><a onclick="editManager(this)">Edit</a></td>'+
                        '<td><a onclick="deleteManager(this)">Del</a></td>'+
                        '</tr>';
                }
                $('#managerTable tbody').html(html);
            }
        })
    }
    deleteManager = async (item) => {
        var id= $(item).parents('tr').attr('id');
        const response = await fetch(apiUrl + 'editProjectManager?oper=del&id=' +id, {
            mode: 'no-cors',
            method: 'post',
        });
        $(item).parents('tr').remove()
    }
    function saveManager() {
        const json = getFormDValues(managerForm)
        $.ajax({
            type: 'GET',
            url: apiUrl + 'saveProjectManager',
            dataType: 'json',
            data: json,
        });
        $("#managerEmail, #managerName").val("");
        setTimeout(loadProjectManagers, 1000)
    };
    function updateManager(item){
        const json = getFormDValues(managerForm);
        var id= $(item).attr('alt');

        $.ajax({
            type: 'POST',
            url: apiUrl + 'editProjectManager?oper=edit&id='+id,
            dataType: 'json',
            data: json,
        });
        $("#managerEmail, #managerName").val("");
        $('a#updateManager').hide()
        $('a#updateManager').removeAttr('alt')
        $('a#createManager').show()
        setTimeout(loadProjectManagers, 1000)
    }
    function editManager(item) {
        var name= $(item).parents('tr').children('td:nth-child(2)').text();
        var email= $(item).parents('tr').children('td:nth-child(3)').text();
        var id= $(item).parents('tr').attr('id');
        $('input#managerName').val(name)
        $('input#managerEmail').val(email)
        // $('input#managerId').val(id)
        $('a#updateManager').show()
        $('a#updateManager').attr('alt', id)
        $('a#createManager').hide()
    }
</script>